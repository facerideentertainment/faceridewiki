"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[273],{9733:function(e,r,t){t.d(r,{d:function(){return u},z:function(){return l}});var n=t(7437),o=t(2265),i=t(1538),s=t(3027),a=t(9354);let u=(0,s.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=o.forwardRef((e,r)=>{let{className:t,variant:o,size:s,asChild:l=!1,...c}=e,d=l?i.g7:"button";return(0,n.jsx)(d,{className:(0,a.cn)(u({variant:o,size:s,className:t})),ref:r,...c})});l.displayName="Button"},1695:function(e,r,t){t.d(r,{q:function(){return n}});let n={projectId:"studio-3687522943-485ca",appId:"1:665741374140:web:232c352ddaef9241ce56b9",apiKey:"AIzaSyBA7Zkh7iARL6D81rLUgreNXDqGQn03WGc",authDomain:"studio-3687522943-485ca.firebaseapp.com",storageBucket:"studio-3687522943-485ca.firebasestorage.app",measurementId:"G-6ZNMXC9L0B",messagingSenderId:"665741374140"}},5606:function(e,r,t){t.d(r,{s:function(){return n}});let n=function(){let e={};return{on(r,t){var n;e[r]||(e[r]=[]),null===(n=e[r])||void 0===n||n.push(t)},off(r,t){var n;e[r]&&(e[r]=null===(n=e[r])||void 0===n?void 0:n.filter(e=>e!==t))},emit(r,t){var n;e[r]&&(null===(n=e[r])||void 0===n||n.forEach(e=>e(t)))}}}()},9558:function(e,r,t){t.d(r,{b:function(){return o}});var n=t(5735);class o extends Error{constructor(e){let r=function(e){let{path:r,operation:t,requestResourceData:o}=e,i={auth:function(e){var r;if(!e)return null;let t={name:e.displayName,email:e.email,email_verified:e.emailVerified,phone_number:e.phoneNumber,sub:e.uid,firebase:{identities:e.providerData.reduce((e,r)=>(r.providerId&&(e[r.providerId]=[r.uid]),e),{}),sign_in_provider:(null===(r=e.providerData[0])||void 0===r?void 0:r.providerId)||"custom",tenant:e.tenantId}};return{uid:e.uid,token:t}}((0,n.v0)().currentUser),method:t,path:r.startsWith("/")?r:"/".concat(r)};return o&&(i.resource={data:o}),i}(e);super("Missing or insufficient permissions: The following request was denied by Firestore Security Rules:\n".concat(JSON.stringify(r,null,2))),this.name="FirebaseError",this.request=r}}},4334:function(e,r,t){t.d(r,{I8:function(){return d},RZ:function(){return f},co:function(){return v},l2:function(){return c},wk:function(){return p}});var n=t(5236),o=t(5735),i=t(9842),s=t(8116),a=t(9854),u=t(7175),l=t(1695);let c=(0,n.C6)().length?(0,n.Mq)():(0,n.ZF)(l.q),d=(0,o.v0)(c),f=(0,i.ad)(c),p=(0,s.$C)(c);(0,a.cF)(c);let v=(0,u.Gb)().then(e=>e?(0,u.IH)(c):null)},1421:function(e,r,t){t.d(r,{cz:function(){return l},fN:function(){return a},lf:function(){return u}});var n=t(9842),o=t(5606),i=t(9558);async function s(e,r){try{return await e}catch(t){let e=new i.b({...r,originalError:t});throw o.s.emit("permission-error",e),e}}async function a(e,r,t){return s((0,n.pl)(e,r,t),{path:e.path,operation:"write",requestResourceData:r})}async function u(e,r){return s((0,n.r7)(e,r),{path:e.path,operation:"update",requestResourceData:r})}async function l(e){return s((0,n.oe)(e),{path:e.path,operation:"delete"})}},9856:function(e,r,t){t.d(r,{FirebaseProvider:function(){return c},f2:function(){return d},sx:function(){return f},aF:function(){return p}});var n=t(7437),o=t(2265),i=t(5735),s=t(4334),a=t(5606);function u(){let[e,r]=(0,o.useState)(null);if((0,o.useEffect)(()=>{let e=e=>{r(e)};return a.s.on("permission-error",e),()=>{a.s.off("permission-error",e)}},[]),e)throw e;return null}let l=(0,o.createContext)(void 0),c=e=>{let{children:r}=e,[t,a]=(0,o.useState)({user:null,isUserLoading:!0,userError:null}),[c,d]=(0,o.useState)(null);(0,o.useEffect)(()=>{s.co.then(d)},[]),(0,o.useEffect)(()=>{if(!s.I8){a({user:null,isUserLoading:!1,userError:Error("Auth service not provided.")});return}a({user:null,isUserLoading:!0,userError:null});let e=(0,i.Aj)(s.I8,e=>{a({user:e,isUserLoading:!1,userError:null})},e=>{console.error("FirebaseProvider: onAuthStateChanged error:",e),a({user:null,isUserLoading:!1,userError:e})});return()=>e()},[]);let f=(0,o.useMemo)(()=>{let e=!!(s.l2&&s.RZ&&s.I8&&s.wk);return{areServicesAvailable:e,firebaseApp:e?s.l2:null,firestore:e?s.RZ:null,auth:e?s.I8:null,functions:e?s.wk:null,analytics:c,user:t.user,isUserLoading:t.isUserLoading,userError:t.userError}},[t,c]);return(0,n.jsxs)(l.Provider,{value:f,children:[(0,n.jsx)(u,{}),r]})},d=()=>{let e=(0,o.useContext)(l);if(void 0===e)throw Error("useFirebase must be used within a FirebaseProvider.");if(!e.areServicesAvailable||!e.firebaseApp||!e.firestore||!e.auth||!e.functions)throw Error("Firebase core services not available. Check FirebaseProvider props.");return{firebaseApp:e.firebaseApp,firestore:e.firestore,auth:e.auth,functions:e.functions,analytics:e.analytics,user:e.user,isUserLoading:e.isUserLoading,userError:e.userError}};function f(e,r){let t=(0,o.useMemo)(e,r);return"object"!=typeof t||null===t||(t.__memo=!0),t}let p=()=>{let{user:e,isUserLoading:r,userError:t}=d();return{user:e,isUserLoading:r,userError:t}}},6763:function(e,r,t){t.d(r,{pm:function(){return f}});var n=t(2265);let o=0,i=new Map,s=e=>{if(i.has(e))return;let r=setTimeout(()=>{i.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,r)},a=(e,r)=>{switch(r.type){case"ADD_TOAST":return{...e,toasts:[r.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===r.toast.id?{...e,...r.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=r;return t?s(t):e.toasts.forEach(e=>{s(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===r.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==r.toastId)}}},u=[],l={toasts:[]};function c(e){l=a(l,e),u.forEach(e=>{e(l)})}function d(e){let{...r}=e,t=(o=(o+1)%Number.MAX_SAFE_INTEGER).toString(),n=()=>c({type:"DISMISS_TOAST",toastId:t});return c({type:"ADD_TOAST",toast:{...r,id:t,open:!0,onOpenChange:e=>{e||n()}}}),{id:t,dismiss:n,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function f(){let[e,r]=n.useState(l);return n.useEffect(()=>(u.push(r),()=>{let e=u.indexOf(r);e>-1&&u.splice(e,1)}),[e]),{...e,toast:d,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},1471:function(e,r,t){t.d(r,{AuthProvider:function(){return d},a:function(){return f}});var n=t(7437),o=t(2265),i=t(9856),s=t(5735),a=t(9842),u=t(1421),l=t(6763);let c=(0,o.createContext)(void 0),d=e=>{let{children:r}=e,{user:t,isUserLoading:d,userError:f}=(0,i.aF)(),{auth:p,firestore:v}=(0,i.f2)(),[h,g]=(0,o.useState)(null),[b,m]=(0,o.useState)(!0),{toast:y}=(0,l.pm)(),E=(0,o.useCallback)(async e=>{if(!e){g(null),m(!1);return}m(!0);try{let r=(await (0,s.ag)(e,!0)).claims.role||"Viewer",t=(0,a.JU)(v,"users",e.uid),n=await (0,a.QT)(t);if(n.exists())g({uid:e.uid,...n.data(),role:r});else{let n={uid:e.uid,email:e.email,role:r,displayName:e.displayName,photoURL:e.photoURL||"https://firebasestorage.googleapis.com/v0/b/studio-3687522943-485ca.firebasestorage.app/o/faceRidepfp.png?alt=media&token=c1ce861e-20f2-4408-b06e-74a80fe13367"};await (0,a.pl)(t,n),g(n)}}catch(e){console.error("Error syncing user document:",e)}finally{m(!1)}},[v]);(0,o.useEffect)(()=>{E(t)},[t,E]),(0,o.useEffect)(()=>{if(!t)return;let e=(0,a.JU)(v,"users",t.uid),r=(0,a.cf)(e,e=>{var r;let n=null==h?void 0:h.role,o=null===(r=e.data())||void 0===r?void 0:r.role;e.exists()&&o&&n&&n!==o&&(console.log("Detected role change in user document, forcing token refresh."),E(t))},e=>{console.error("Error listening to user document:",e)});return()=>r()},[t,v,E,h]);let w=(0,o.useCallback)(async(e,r)=>{try{await (0,s.e5)(p,e,r)}catch(e){throw console.error("Firebase Login Error:",e),e}},[p]),S=(0,o.useCallback)(async(e,r,t)=>{let n=await (0,s.Xb)(p,e,r);await (0,s.ck)(n.user,{displayName:t,photoURL:"https://firebasestorage.googleapis.com/v0/b/studio-3687522943-485ca.firebasestorage.app/o/faceRidepfp.png?alt=media&token=c1ce861e-20f2-4408-b06e-74a80fe13367"}),await E(n.user)},[p,E]),A=(0,o.useCallback)(async()=>{try{await (0,s.w7)(p),g(null)}catch(e){console.error("Error logging out:",e)}},[p]),k=(0,o.useCallback)(async e=>{if(!t)throw Error("Not authenticated");let{displayName:r,photoURL:n}=e,o={};void 0!==r&&(o.displayName=r),void 0!==n&&(o.photoURL=n),await (0,s.ck)(t,o);let i=(0,a.JU)(v,"users",t.uid);await (0,u.lf)(i,o),g(e=>e?{...e,...o}:null)},[t,v]),I=(0,o.useCallback)(async()=>{t&&await E(t)},[t,E]);return(0,n.jsx)(c.Provider,{value:{user:h,loading:b||d,error:f,login:w,signup:S,logout:A,updateUserProfile:k,forceRefresh:I},children:r})},f=()=>{let e=(0,o.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},9354:function(e,r,t){t.d(r,{cn:function(){return i}});var n=t(4839),o=t(6164);function i(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,o.m6)((0,n.W)(r))}}}]);